# BOHB over Growing ConvNets
### \- Joint Architecture Search and Hyperparameter Optimization of a Convolutional Neural Network \-
<br>

This repository contains a heavily modified re-implementation of the [NORTH-Select](https://github.com/neurogenesisauthors/Neurogenesis) neurogenesis strategy that dynamically grows layers during training,
and experiments with BOHB ([SMAC3](https://github.com/automl/SMAC3)'s SMAC4MF facade) that optimizes architectural-, neurogenesis- and training-hyperparameters jointly.

To reproduce the results from the paper [_BOHB over Growing ConvNets_](paper.pdf), simply execute all commands in the order they are presented.

## Installation
I use [anaconda](https://www.anaconda.com/products/individual) to manage dependencies.
```bash
conda env create -f environment.yml  # may take a while
conda activate jahs
export PYTHONPATH=.
```

## Running the code
All commands are executed from the project's root directory.
### Joint search (for 6h)
```bash
python src/outer_bohb.py --runtime=21600 --max_epochs=10 --device=cuda --working_dir=./tmp
```

### Additional experiments, and the figures and tables (~6h)
Including sweep across q-thresholds and testing performance of baseline and incumbent configurations.
```bash
python src/experiments/run_experiments.py
python src/experiments/figures.py
```

### Unit tests for the growable ConvNet
```bash
python -m pytest -s
```

## File structure
*  src/
    * [growable_models.py](src/growable_models.py)<br>
      contains the code for neurogenesis: a heavily modified re-implementation of the NORTH-Select strategy. The resulting model can be used just like any other PyTorch model.
    * [outer_bohb.py](src/outer_bohb.py)<br>
      contains code for running SMAC4MF on the growable ConvNet.
    * experiments/<br>
      contains code for additional experiments and the figures.
    * test/<br>
      contains unit tests.
* cfgs/<br>
  contains the final incumbent configurations and ones generated by and used during the [experiments](src/experiments/run_experiment.py).
* logs/<br>
  contains the data generated by the experiments (serialized to json).
* figs/<br>
  contains the figures and plots generated by [figures.py](src/experiments/figures.py).

    




